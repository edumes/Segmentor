[tool:pytest]
# Configuração do pytest para testes de compatibilidade multiplataforma

# Diretórios de teste
testpaths = .

# Padrões de arquivos de teste
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Marcadores personalizados
markers =
    macos: Testes específicos do macOS
    windows: Testes específicos do Windows  
    linux: Testes específicos do Linux
    apple_silicon: Testes específicos do Apple Silicon (M1/M2/M3)
    compatibility: Testes de compatibilidade multiplataforma
    platform: Testes relacionados à detecção de plataforma
    slow: Testes que demoram mais para executar
    integration: Testes de integração
    unit: Testes unitários
    ffmpeg: Testes que requerem FFmpeg
    gui: Testes de interface gráfica

# Opções padrão
addopts = 
    -v
    --tb=short
    --strict-markers
    --strict-config
    --color=yes
    --durations=10
    --cov=.
    --cov-report=term-missing
    --cov-report=html:htmlcov
    --cov-fail-under=80

# Filtros de warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore:.*Qt.*:UserWarning
    ignore:.*PyQt.*:UserWarning

# Configurações de coleta
collect_ignore = [
    "venv",
    "build",
    "dist",
    ".git",
    "__pycache__",
    "htmlcov"

# Timeout para testes (em segundos)
timeout = 300

# Configurações específicas por plataforma
# Essas configurações são aplicadas automaticamente baseado na plataforma atual

# Variáveis de ambiente para testes
env =
    PYTHONPATH = .
    QT_QPA_PLATFORM = offscreen
    PYTEST_RUNNING = 1

# Configurações de logging
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Configurações de cache
cache_dir = .pytest_cache

# Configurações de paralelização (se pytest-xdist estiver instalado)
# -n auto detecta automaticamente o número de CPUs
# Descomente a linha abaixo se quiser usar paralelização
# addopts = -n auto

# Configurações mínimas de versão do Python
minversion = 3.8

# Configurações de descoberta de testes
testmon_off = false

# Configurações para diferentes ambientes
[tool:pytest:macos]
# Configurações específicas do macOS
addopts = 
    -v
    --tb=short
    -m "not windows and not linux"

[tool:pytest:windows] 
# Configurações específicas do Windows
addopts = 
    -v
    --tb=short
    -m "not macos and not linux"

[tool:pytest:linux]
# Configurações específicas do Linux
addopts = 
    -v
    --tb=short
    -m "not macos and not windows"